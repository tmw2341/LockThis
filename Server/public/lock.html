<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>View Locks</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
</head>

<body>
  <div id="login">
    <button class="btn btn-lg btn-primary btn-block" onclick="getLocks()">View Locks</button>
  </div>
  <div>
    <table id="table">

    </table>
  </div>
  <script>
    function getLocks() {

      let celement = (tag, text) => {
        let element = document.createElement(tag)
        element.innerHTML = text
        return element
      }

      var x = sessionStorage.getItem("Username");
      var y = sessionStorage.getItem("Password");

      console.log("running")
      $.ajax({
        url: 'http://lockthis.ece.iastate.edu:3000/user/locks',
        dataType: 'json',
        type: 'post',
        contentType: 'application/json',
        data: JSON.stringify({
          "username": x,
          "password": y
        }),
        processData: false,
        success: function(data, textStatus, jQxhr) {
          console.log(data)
          $('#login').hide()
          // var myObject = data;
          // console.log(Object.keys(myObject)[1]);


          createTable(data.locks);
          return;
          var jsonData  = JSON.parse(data);

          return;
          for(var i = 0; i < jsonData.length; i++){
            console.log(jsonData[0].stringify());
          }
        },
        error: function(jqXhr, textStatus, errorThrown) {
          console.log("failed " + errorThrown);
        }
      })
    }

    function createTable(data)
    {
      console.log("<tr><td>" + JSON.stringify(data[0]) + "</td></tr>");
      $('#table').innerHTML = "<tr><td>" + data + "</td></tr>";
    }

  </script>
</body>

</html>
